#!/bin/env bash
LIGHT=`brightnessctl | awk 'NR == 2 {print $4}' | tr -d '(%)'`
echo -e "\n[ Current light value is $LIGHT ]\n"

if [ $# -eq 1 ]; then
    if [[ $(xrandr | grep " connected " | awk '{ print$1 }') == eDP-1 ]]; then # only eDP-1 connected 
        brightnessctl s $1

        LIGHT=`brightnessctl | awk 'NR == 2 {print $4}' | tr -d '(%)'`
   
    elif [[ $(xrandr | grep " connected " | awk '{ print$1 }' | sed ':a;N;$!ba;s/\n/ /g') == "eDP-1 HDMI-1-0" ]];then # both eDP-1 and HDMI-1-0 connected

        #internal monitor
        brightnessctl s $1
        LIGHT=`brightnessctl | awk 'NR == 2 {print $4}' | tr -d '(%)'`

        # external monitor
        ddcutil setvcp --bus=12 10 $LIGHT

    fi

    if [[ $(echo -e $1)  =~ "+" ]]; then
        echo -e "[ Set light to $NPERC% ]\n"
        dunstify -h string:x-dunst-stack-tag:light "   $LIGHT%" -t 2000
    elif [[ $(echo -e $1)  =~ "-" ]]; then
        echo -e "[ Set light to $NPERC% ]\n"
        dunstify -h string:x-dunst-stack-tag:light "   $LIGHT%" -t 2000
    fi

echo -e "\n[ New light value is $LIGHT ]\n"

else
    echo -e "Valid Values: "
    echo -e "   specific value              Example: 500"
    echo -e "   percentage value            Example: 50%"
    echo -e "   specific delta              Example: 50- or +10"
    echo -e "   percentage delta            Example: 50%- or +10%"
fi
