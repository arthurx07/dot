#!/bin/env bash
light0=`brightnessctl | awk 'NR == 2 {print $4}' | tr -d '(%)'`
echo -e "\n[ Current light value is $light0 ]\n"

if [ $# -eq 1 ]; then
    brightnessctl s $1
    light=`brightnessctl | awk 'NR == 2 {print $4}' | tr -d '(%)'`

    if [[ $1  =~ "+" ]]; then
        dunstify -h string:x-dunst-stack-tag:light "   $light%" -t 2000
    elif [[ $1  =~ "-" ]]; then
        dunstify -h string:x-dunst-stack-tag:light "   $light%" -t 2000
    fi
   
    if [[ $(xrandr | grep " connected " | awk '{ print$1 }' | sed ':a;N;$!ba;s/\n/ /g') == "eDP-1 HDMI-1-0" ]];then # both eDP-1 and HDMI-1-0 connected
        ddcutil setvcp --bus=$(ddcutil detect | awk 'NR==14 {print $3}' | sed 's/\/dev\/i2c-//'
12) 10 $light
    fi

    echo -e "\n[ New light value is $light ]\n"

else
    echo -e "Valid Values: "
    echo -e "   specific value              Example: 500"
    echo -e "   percentage value            Example: 50%"
    echo -e "   specific delta              Example: 50- or +10"
    echo -e "   percentage delta            Example: 50%- or +10%"
fi
